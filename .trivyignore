# =============================================================================
# TRIVY IGNORE FILE - Container & Dependency Vulnerability Exceptions
# =============================================================================
# Purpose: Document and suppress known false positives or accepted risks
# Documentation: https://aquasecurity.github.io/trivy/latest/docs/vulnerability/examples/filter/
# Last Review: 2025-09-06
# Next Review: 2025-10-06 (Monthly review cycle)
# =============================================================================

# =============================================================================
# FALSE POSITIVES
# =============================================================================
# These CVEs are incorrectly reported or don't apply to our usage

# Node.js base image false positives
CVE-2023-38545  # libcurl - Not used in our Node.js applications
CVE-2023-44487  # HTTP/2 Rapid Reset - Mitigated by rate limiting
CVE-2023-46809  # Node.js permission model - Not applicable to container runtime

# Alpine Linux false positives (if using Alpine base)
CVE-2023-52425  # libexpat - Only affects XML parsing, not used
CVE-2023-52426  # libexpat - Only affects XML parsing, not used

# =============================================================================
# ACCEPTED RISKS - DEVELOPMENT DEPENDENCIES
# =============================================================================
# These vulnerabilities only affect development dependencies, not production

# Testing libraries (not in production containers)
CVE-2023-45133  # @babel/traverse - Dev dependency only
CVE-2024-4068   # braces - Used only in build process
CVE-2024-28849  # follow-redirects - Dev dependency in webpack
CVE-2024-37890  # ws - WebSocket in dev server only

# Build tools (not in production runtime)
CVE-2024-4067   # micromatch - Build-time glob matching
CVE-2024-28863  # tar - Used only during npm install in build

# =============================================================================
# ACCEPTED RISKS - WITH MITIGATIONS
# =============================================================================
# These vulnerabilities have been assessed and mitigated

# PostgreSQL client library
CVE-2024-7348   # Time-of-check time-of-use - Mitigated by connection pooling
# Mitigation: Using pgBouncer for connection management
# Review Date: 2025-09-01
# Owner: Infrastructure Team

# Redis client
CVE-2023-36665  # Prototype pollution - Mitigated by input validation
# Mitigation: All Redis operations use parameterized queries
# Review Date: 2025-09-01
# Owner: Backend Team

# =============================================================================
# PENDING FIXES
# =============================================================================
# These will be fixed in upcoming releases

# Waiting for upstream fix (Track: https://github.com/vendor/lib/issues/123)
CVE-2024-12345  # some-library - Fix expected in v2.0.0 (ETA: 2025-10-01)
# Temporary Mitigation: Input validation at API gateway
# Owner: Security Team
# Tracking Issue: JIRA-SEC-456

# =============================================================================
# LOW SEVERITY - ACCEPTED
# =============================================================================
# Low severity issues that don't warrant immediate action

# Documentation generation tools
CVE-2023-26115  # word-wrap - Only used in JSDoc generation
CVE-2023-26116  # word-wrap - Only used in JSDoc generation

# Deprecated packages (migration planned)
CVE-2022-25883  # semver - Migration to v8 planned in Q4 2025
# Tracking: JIRA-TECH-789

# =============================================================================
# WINDOWS-SPECIFIC VULNERABILITIES
# =============================================================================
# Not applicable as we run on Linux containers

CVE-*-WINDOWS-*  # All Windows-specific CVEs
CVE-*-WIN32-*    # All Win32-specific CVEs

# =============================================================================
# TEMPORARY SUPPRESSIONS
# =============================================================================
# Temporary suppressions with expiration dates

# EXPIRES: 2025-10-01 - Waiting for security patch
CVE-2024-99999  # critical-lib - Vendor patch in progress
# Mitigation: Disabled affected feature flag
# Owner: Product Team
# Review: Daily monitoring until patched

# =============================================================================
# NOTES FOR SECURITY TEAM
# =============================================================================
# 1. Review this file monthly during security review meetings
# 2. Remove suppressions when fixes are available
# 3. Document all mitigations with owner and review date
# 4. Never suppress CRITICAL vulnerabilities without CTO approval
# 5. All suppressions must have a tracking issue
#
# To test locally:
# trivy image --ignorefile .trivyignore your-image:tag
#
# To list all ignored CVEs:
# grep "^CVE-" .trivyignore | sort | uniq
#
# Questions? Contact: security@company.com
# =============================================================================

# =============================================================================
# AUDIT LOG
# =============================================================================
# 2025-09-06: Initial file creation - @security-team
# 2025-09-06: Added false positives section - @devops
# 2025-09-06: Added accepted risks with mitigations - @security-team
# ============================================================================= 