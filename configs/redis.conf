# Generated from spec: E01-F02-T03 (Docker and Database Services Setup)
# Spec ID: ce5140df
# Redis configuration for multi-account support

# Number of databases
databases 16

# Database allocation with naming convention:
# 0: session:cache - Session and auth cache
# 1: kis:account:1:ratelimit - KIS account 1 rate limiting
# 2: kis:account:2:ratelimit - KIS account 2 rate limiting
# 3: kis:account:3:ratelimit - KIS account 3 rate limiting
# 4: kis:account:4:ratelimit - KIS account 4 rate limiting
# 5: kis:account:5:ratelimit - KIS account 5 rate limiting
# 6: surge:detection - Surge detection cache
# 7: order:queue - Order processing queue
# 8: metrics:account - Account metrics and analytics
# 9-15: Reserved for future expansion

# Save the DB on disk
save 900 1        # after 900 sec (15 min) if at least 1 key changed
save 300 10       # after 300 sec (5 min) if at least 10 keys changed
save 60 10000     # after 60 sec if at least 10000 keys changed

# Enable append only file
appendonly yes
appendfsync everysec

# Compression
rdbcompression yes
rdbchecksum yes

# Max memory policy
maxmemory-policy allkeys-lru

# Log level
loglevel notice

# Bind to all interfaces (for Docker)
bind 0.0.0.0

# Disable protected mode for Docker
protected-mode no

# TCP listen() backlog
tcp-backlog 511

# TCP keepalive
tcp-keepalive 300

# Timeout
timeout 0

# Database filename
dbfilename dump.rdb

# Working directory
dir /data

# Replication (if needed later)
# replicaof <masterip> <masterport>

# Security (add password in production)
# requirepass your_redis_password

# Limits
maxclients 10000

# Slow log
slowlog-log-slower-than 10000
slowlog-max-len 128

# Latency monitor
latency-monitor-threshold 0

# Event notification
notify-keyspace-events ""

# Advanced config
hash-max-ziplist-entries 512
hash-max-ziplist-value 64
list-max-ziplist-size -2
list-compress-depth 0
set-max-intset-entries 512
zset-max-ziplist-entries 128
zset-max-ziplist-value 64
hll-sparse-max-bytes 3000
stream-node-max-bytes 4096
stream-node-max-entries 100
activerehashing yes
client-output-buffer-limit normal 0 0 0
client-output-buffer-limit replica 256mb 64mb 60
client-output-buffer-limit pubsub 32mb 8mb 60
hz 10
dynamic-hz yes
aof-rewrite-incremental-fsync yes
rdb-save-incremental-fsync yes