# E01-F05 Database Infrastructure - Context Log

## Revision History

### 2025-09-05: Storage Strategy Update

**Change**: Updated spec to remove partitioned filesystem assumptions
**Reason**: Previous architectural discussion decided against splitting into multiple partitions

**Key Changes Made:**
1. **Storage Allocation**: Changed from dedicated LVM volumes to subdirectories in main filesystem
   - PostgreSQL: `/data/jts/databases/postgresql` (was `/var/lib/postgresql` on dedicated LVM)
   - ClickHouse: `/data/jts/databases/clickhouse` (was `/var/lib/clickhouse` on dedicated LVM)
   - MongoDB: `/data/jts/databases/mongodb` (was `/var/lib/mongodb` on dedicated LVM)
   - Redis: `/data/jts/databases/redis` (was `/var/lib/redis` on dedicated LVM)

2. **Implementation Steps**: Removed LVM partition creation steps, replaced with simple directory creation
   - No more `lvcreate` commands
   - No more filesystem formatting with `mkfs.ext4`
   - Added permission setting for each database user

3. **Docker Volumes**: Updated all docker-compose volume mappings to use new paths

4. **Dependencies**: Updated F01 dependency description to reflect directory structure instead of LVM

5. **Notes Section**: Added clarification about single filesystem approach and Docker volume isolation

**Benefits of Single Filesystem Approach:**
- Simplified storage management
- No need for partition resizing
- Easier backup and migration
- Docker handles storage isolation
- Flexibility to adjust storage allocation without repartitioning

**Trade-offs Considered:**
- Less physical isolation between databases
- Shared filesystem I/O
- Mitigated by Docker's storage driver and potential quotas

---

## Original Implementation Context

**Created**: 2025-08-24
**Type**: Feature Specification
**Status**: Draft â†’ Under Revision
**Epic**: E01 - System Infrastructure